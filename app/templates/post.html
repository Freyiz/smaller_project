{% extends 'base.html' %}
{% import 'bootstrap/wtf.html' as wtf %}
{% import "_macros.html" as macros %}

{% block title %}评论{% endblock %}

{% block page_content %}
    {% include '_posts.html' %}
    {{ wtf.quick_form(form) }}
    {% include '_comments.html' %}
    {% if pagination.pages > 1 %}
        {{ macros.pagination_widget(pagination, '.post', id=posts[0].id) }}
        <form method="post" class="form" role="form">
            {{ form2.hidden_tag() }}
            <div class="form-group">{{ form2.page_num(class="page_num") }}{{ form2.submit(class="jump", disabled='disabled') }}</div>
        </form>
    {% endif %}
{% endblock %}

{% block scripts %}
    {{ super() }}
    {{ pagedown.include_pagedown() }}
    <script type="text/javascript">
        $(function () {
            $('.page_num').bind('input propertychange', function() {
                var val = $(this).val();
                if((/^(\+|-)?\d+$/.test(val)) && val > 0 && val <= {{ pages }}) {
                    $('.jump').removeAttr('disabled').css('color', '#ffffff');
                } else {
                    $('.jump').attr('disabled', 'disabled').css('color', 'gray');
                }
                if (val > 99) {
                    $(this).css('padding-left', '6px');
                }
                else if (val > 9) {
                    $(this).css('padding-left', '10px');
                }
                else {
                    $(this).css('padding-left', '14px')
                }
            });
        });
    </script>{% endblock %}